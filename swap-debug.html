<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Swap Debug</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1a1a1a;
            color: #0f0;
        }
        .check { color: #0f0; }
        .error { color: #f00; }
        .warning { color: #ff0; }
        pre { background: #000; padding: 10px; border: 1px solid #0f0; }
    </style>
</head>
<body>
    <h1>Swap Page Diagnostic</h1>
    <div id="results"></div>

    <script src="js/libs/ethers-5.7.2.umd.min.js"></script>
    <script src="kodiak-api.js"></script>
    <script src="swap.js"></script>

    <script>
        const results = document.getElementById('results');
        
        function log(msg, type = 'check') {
            const div = document.createElement('div');
            div.className = type;
            div.textContent = msg;
            results.appendChild(div);
        }

        async function runDiagnostics() {
            log('=== Starting Diagnostics ===');
            
            // Check ethers.js
            if (typeof ethers !== 'undefined') {
                log('✓ ethers.js loaded', 'check');
            } else {
                log('✗ ethers.js NOT loaded', 'error');
            }
            
            // Check Kodiak API
            if (typeof KodiakAPI !== 'undefined') {
                log('✓ KodiakAPI class available', 'check');
                const kodiakAPI = new KodiakAPI();
                log('✓ KodiakAPI instance created', 'check');
                
                // Test Kodiak API
                try {
                    log('Testing Kodiak API quote...');
                    const quote = await kodiakAPI.getQuote(
                        '0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE', // BERA
                        '0xf7C464c7832e59855aa245Ecc7677f54B3460e7d', // DP
                        '1',
                        null,
                        null,
                        18
                    );
                    log('✓ Kodiak API quote successful', 'check');
                    log('Quote data: ' + JSON.stringify(quote, null, 2));
                } catch (error) {
                    log('✗ Kodiak API quote failed: ' + error.message, 'error');
                }
            } else {
                log('✗ KodiakAPI class NOT available', 'error');
            }
            
            // Check SwapManager
            if (typeof SwapManager !== 'undefined') {
                log('✓ SwapManager class available', 'check');
            } else {
                log('✗ SwapManager class NOT available', 'error');
            }
            
            // Check global swapManager instance
            setTimeout(() => {
                if (typeof swapManager !== 'undefined') {
                    log('✓ swapManager instance created', 'check');
                    log('swapManager provider: ' + (swapManager.provider ? 'OK' : 'NULL'), swapManager.provider ? 'check' : 'warning');
                    log('swapManager kodiakAPI: ' + (swapManager.kodiakAPI ? 'OK' : 'NULL'), swapManager.kodiakAPI ? 'check' : 'error');
                } else {
                    log('✗ swapManager instance NOT created', 'error');
                }
                
                log('\n=== Diagnostics Complete ===');
            }, 2000);
        }

        window.addEventListener('load', runDiagnostics);
    </script>
</body>
</html>
